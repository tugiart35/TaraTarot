# 🔍 .cursorrules Audit - Tarot Web Application

**Analiz Tarihi:** $(date)  
**Framework:** Next.js 15.4.4 + TypeScript  
**Branch:** chore/inventory-safe

---

## 📋 Mevcut Kurallar Analizi

### 🎯 Proje Kuralları (Mevcut)

```typescript
// User Rules (Memory'den)
- Always respond in Türkçe
- Port 3111 kullan (development server)
- Backend integration noktalarında 'burada backend'e bağlanılacak' yorumu ekle
- Kısa Türkçe yorumlar ekle (main component functions)
- Code review'da info block ekle (file top'unda)
- Next.js 12+ otomatik JSX transform (explicit React imports gereksiz)
- Single quotes, trailing commas, TypeScript type annotations
```

### 🏗️ Kod Stili Kuralları

```typescript
// Mevcut Stil
- Single quotes for imports
- Trailing commas on last line of objects
- Imports each on its own line
- TypeScript type annotations to function parameters
- Break long argument lists onto separate lines
- Catch errors as unknown and handle safely
- Files end with newline
- Keep console.log statements until production
```

---

## ⚠️ Tespit Edilen Çelişkiler

### 1. 🔴 React Import Çelişkisi

```typescript
// Kural: "Next.js 12+ otomatik JSX transform, explicit React imports gereksiz"
// Gerçek: Birçok dosyada explicit React import var
import React from 'react'; // ❌ Gereksiz
import { useState, useEffect } from 'react'; // ✅ Gerekli
```

### 2. 🟡 Quote Style Tutarsızlığı

```typescript
// Kural: "Single quotes for imports"
// Gerçek: Mixed usage
import { Component } from 'react'; // ✅ Single quote
import { Component } from 'react'; // ❌ Double quote (prettier default)
```

### 3. 🟠 TypeScript Type Annotation Eksikliği

```typescript
// Kural: "TypeScript type annotations to function parameters"
// Gerçek: Birçok fonksiyonda eksik
function handleClick(event) { // ❌ Type eksik
function handleClick(event: MouseEvent) { // ✅ Type var
```

### 4. 🔵 Console.log Kullanımı

```typescript
// Kural: "Keep console.log statements until production"
// Gerçek: Production'da console.log'lar var
console.log('Debug info'); // ❌ Production'da olmamalı
```

---

## 🚨 Eksik Kurallar

### 1. 🔐 Güvenlik Kuralları

```typescript
// Eksik: Environment variable güvenliği
// Öneri:
- Never expose service_role in client code
- Always validate environment variables
- Use proper error handling for sensitive operations
```

### 2. 🎨 Component Kuralları

```typescript
// Eksik: RSC (React Server Components) kuralları
// Öneri:
- Use 'use client' directive for client components
- Separate server and client components properly
- Avoid client hooks in server components
```

### 3. 📊 Performance Kuralları

```typescript
// Eksik: Performance optimization kuralları
// Öneri:
- Use dynamic imports for heavy components
- Implement proper loading states
- Optimize bundle size
```

### 4. 🧪 Testing Kuralları

```typescript
// Eksik: Testing kuralları
// Öneri:
- Write unit tests for utilities
- Test critical user flows
- Maintain test coverage above 80%
```

---

## 📝 Önerilen .cursorrules Güncellemeleri

### 1. 🔧 Mevcut Kuralları Düzelt

```typescript
// React Import Kuralı (Güncellenmiş)
- Next.js 15+ otomatik JSX transform kullan
- Explicit React import'ları sadece hooks için kullan
- import React from 'react' gereksiz, import { useState } from 'react' gerekli

// Quote Style Kuralı (Güncellenmiş)
- Prettier default'u kullan (double quotes)
- Import'larda tutarlılık sağla
- String literals için single quotes tercih et

// TypeScript Kuralı (Güncellenmiş)
- Function parametrelerinde type annotation zorunlu
- Return type'ları belirt (complex functions için)
- any type kullanımını yasakla
```

### 2. 🆕 Yeni Kurallar Ekle

```typescript
// Güvenlik Kuralları
- Environment variables'ları validate et
- Service role'ü client code'da kullanma
- Sensitive data'yı log'lama
- Input validation zorunlu

// RSC Kuralları
- Server component'lerde 'use client' kullanma
- Client hooks'ları sadece client component'lerde kullan
- Data fetching'i server component'lerde yap

// Performance Kuralları
- Heavy component'leri lazy load et
- Bundle size'ı monitor et
- Unused imports'ları temizle
- Image optimization kullan

// Testing Kuralları
- Critical path'leri test et
- Utility function'ları test et
- Error boundary'leri test et
- Test coverage %80+ olsun
```

---

## 🎯 Kurallar Uygulama Durumu

### ✅ İyi Uygulanan Kurallar

| Kural             | Uygulama | Durum       |
| ----------------- | -------- | ----------- |
| Türkçe yanıt      | %100     | ✅ Mükemmel |
| Port 3111         | %100     | ✅ Mükemmel |
| Backend yorumları | %80      | ✅ İyi      |
| Info block'lar    | %70      | ✅ İyi      |

### ⚠️ Kısmen Uygulanan Kurallar

| Kural            | Uygulama | Durum                |
| ---------------- | -------- | -------------------- |
| Single quotes    | %60      | ⚠️ Tutarsız          |
| TypeScript types | %50      | ⚠️ Eksik             |
| Trailing commas  | %70      | ⚠️ Kısmen            |
| Console.log      | %30      | ⚠️ Production'da var |

### ❌ Uygulanmayan Kurallar

| Kural          | Uygulama | Durum        |
| -------------- | -------- | ------------ |
| React imports  | %20      | ❌ Çelişkili |
| Error handling | %40      | ❌ Eksik     |
| File endings   | %60      | ❌ Tutarsız  |

---

## 🔧 Kurallar Güncelleme Önerileri

### 1. 📋 Acil Güncellemeler

```typescript
// .cursorrules dosyasına eklenecek:

## React & Next.js Rules
- Use 'use client' directive for client components
- Avoid explicit React imports (Next.js 15+ auto-import)
- Separate server and client components properly
- Use proper data fetching patterns

## TypeScript Rules
- Always add type annotations to function parameters
- Use strict mode (no any, no implicit any)
- Add return types for complex functions
- Use proper error types (unknown instead of any)

## Security Rules
- Never expose service_role in client code
- Validate all environment variables
- Use proper error handling for sensitive operations
- Implement rate limiting for API endpoints

## Performance Rules
- Use dynamic imports for heavy components
- Implement proper loading states
- Optimize bundle size (monitor with bundle-analyzer)
- Clean unused imports and dead code
```

### 2. 🎨 Stil Kuralları Güncellemesi

```typescript
// Mevcut stil kurallarını güncelle:

## Code Style (Updated)
- Use double quotes (Prettier default)
- Add trailing commas to objects and arrays
- Break long lines (max 100 characters)
- Use consistent indentation (2 spaces)
- Add JSDoc comments for complex functions
- Use meaningful variable names
- Implement proper error boundaries
```

### 3. 🧪 Testing Kuralları

```typescript
// Yeni testing kuralları:

## Testing Rules
- Write unit tests for utility functions
- Test critical user flows (auth, payment, reading)
- Maintain test coverage above 80%
- Use proper test data and mocks
- Test error scenarios and edge cases
- Implement integration tests for API endpoints
```

---

## 📊 Kurallar Etkinlik Analizi

### 🎯 En Etkili Kurallar

1. **Türkçe yanıt** - %100 uygulanıyor
2. **Port 3111** - %100 uygulanıyor
3. **Backend yorumları** - %80 uygulanıyor
4. **Info block'lar** - %70 uygulanıyor

### 🔧 En Az Etkili Kurallar

1. **React imports** - %20 uygulanıyor (çelişkili)
2. **TypeScript types** - %50 uygulanıyor (eksik)
3. **Error handling** - %40 uygulanıyor (eksik)
4. **Console.log** - %30 uygulanıyor (production'da var)

---

## 🚀 Kurallar Optimizasyonu

### 1. 📈 Uygulama Oranını Artır

```typescript
// Mevcut kuralları güçlendir:
- TypeScript strict mode'u zorla
- ESLint kurallarını sıkılaştır
- Prettier konfigürasyonunu optimize et
- Husky pre-commit hooks ekle
```

### 2. 🎯 Yeni Kurallar Ekle

```typescript
// Eksik alanları kapat:
- RSC best practices
- Security guidelines
- Performance optimization
- Testing standards
```

### 3. 🔄 Kuralları Güncelle

```typescript
// Eski kuralları modernize et:
- Next.js 15+ uyumlu kurallar
- TypeScript 5+ strict mode
- Modern React patterns
- Security best practices
```

---

## 📋 Kurallar Uygulama Planı

### Phase 1: Critical Fixes (1 hafta)

- [ ] React import kurallarını düzelt
- [ ] TypeScript type annotation'ları ekle
- [ ] Console.log'ları production'dan temizle
- [ ] Error handling'i iyileştir

### Phase 2: New Rules (2 hafta)

- [ ] RSC kurallarını ekle
- [ ] Security kurallarını ekle
- [ ] Performance kurallarını ekle
- [ ] Testing kurallarını ekle

### Phase 3: Optimization (1 hafta)

- [ ] ESLint konfigürasyonunu güncelle
- [ ] Prettier kurallarını optimize et
- [ ] Husky pre-commit hooks ekle
- [ ] CI/CD pipeline'a kuralları entegre et

---

## 🎯 Sonuç

**Mevcut Kurallar:** 8 adet (5 iyi, 2 kısmen, 1 çelişkili)  
**Eksik Kurallar:** 12 adet (güvenlik, RSC, performance, testing)  
**Uygulama Oranı:** %60 (orta seviye)

**Önerilen Aksiyonlar:**

1. Mevcut kuralları düzelt (1 hafta)
2. Yeni kurallar ekle (2 hafta)
3. Uygulama oranını artır (1 hafta)
4. Monitoring ve feedback sistemi kur (sürekli)

**Beklenen Faydalar:**

- Code quality %30 artış
- Security risk %50 azalış
- Performance %20 iyileşme
- Developer experience %40 artış
