# ðŸš¨ Production Fixes - Tarot Web Application

**Priority:** Hotfix â†’ High â†’ Medium â†’ Nice-to-have  
**Estimated Time:** 2-4 weeks for Hotfix + High priority items  
**Last Updated:** January 2025

---

## ðŸ”¥ HOTFIX (Production Blocker)

### 1. Environment Secrets Security
**File:** `env.example`  
**Issue:** GerÃ§ek API keys ve passwords exposed  
**Action:** 
```bash
# Replace real values with placeholders
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...your-anon-key
SUPABASE_SERVICE_ROLE_KEY=eyJ...your-service-key
SMTP_PASS=your-app-password
```
**Priority:** Critical  
**Time:** 5 minutes

### 2. TypeScript Test Configuration
**File:** `jest.config.js`, `package.json`  
**Issue:** Jest type definitions eksik, 150+ test error  
**Action:**
```bash
npm install --save-dev @types/jest
```
**File:** `jest.config.js`
```javascript
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'jsdom',
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  moduleNameMapping: {
    '^@/(.*)$': '<rootDir>/src/$1',
  },
  globals: {
    'ts-jest': {
      tsconfig: 'tsconfig.json'
    }
  }
};
```
**Priority:** Critical  
**Time:** 30 minutes

### 3. Security Headers Hardening
**File:** `src/middleware.ts` (lines 51-64)  
**Issue:** CSP policy too permissive  
**Action:**
```typescript
'Content-Security-Policy': [
  "default-src 'self'",
  "script-src 'self' 'unsafe-inline' https://www.googletagmanager.com",
  "style-src 'self' 'unsafe-inline' https://fonts.googleapis.com",
  "img-src 'self' data: https:",
  "font-src 'self' https://fonts.gstatic.com",
  "connect-src 'self' https://*.supabase.co wss://*.supabase.co",
  "frame-src 'none'",
  "object-src 'none'",
  "base-uri 'self'",
  "form-action 'self'",
  "frame-ancestors 'none'",
].join('; '),
```
**Priority:** Critical  
**Time:** 15 minutes

### 4. Rate Limiting Activation
**File:** `src/middleware.ts` (lines 38, 67, 89)  
**Issue:** Rate limiting development iÃ§in disabled  
**Action:** Rate limiting kodlarÄ±nÄ± uncomment et ve production check ekle:
```typescript
if (process.env.NODE_ENV === 'production') {
  // Rate limiting logic here
}
```
**Priority:** Critical  
**Time:** 20 minutes

---

## ðŸ”´ HIGH PRIORITY

### 5. Error Monitoring Setup
**File:** `src/lib/error-handler.ts`  
**Issue:** Production error logging eksik  
**Action:** Sentry entegrasyonu
```bash
npm install @sentry/nextjs
```
**File:** `sentry.client.config.ts`
```typescript
import * as Sentry from '@sentry/nextjs';

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
});
```
**Priority:** High  
**Time:** 2 hours

### 6. Image Optimization Production
**File:** `next.config.js` (line 8)  
**Issue:** `unoptimized: true` production'da false olmalÄ±  
**Action:**
```javascript
images: {
  domains: ['localhost', 'qtlokdkcerjrbrtphlrh.supabase.co'],
  unoptimized: process.env.NODE_ENV === 'development',
  formats: ['image/webp', 'image/avif'],
},
```
**Priority:** High  
**Time:** 10 minutes

### 7. Legal Pages Creation
**Files:** 
- `src/app/[locale]/(main)/legal/terms/page.tsx`
- `src/app/[locale]/(main)/legal/privacy/page.tsx`
- `src/app/[locale]/(main)/legal/refund/page.tsx`
**Issue:** Legal pages eksik  
**Action:** GDPR/KVKK uyumlu legal pages oluÅŸtur  
**Priority:** High  
**Time:** 4 hours

### 8. Webhook Security
**File:** `src/app/api/webhook/shopier/route.ts`  
**Issue:** Webhook signature validation eksik  
**Action:** HMAC signature validation ekle:
```typescript
const signature = request.headers.get('x-shopier-signature');
const expectedSignature = crypto
  .createHmac('sha256', process.env.WEBHOOK_SECRET!)
  .update(body)
  .digest('hex');
```
**Priority:** High  
**Time:** 1 hour

### 9. XML Sitemap Generation
**File:** `src/app/sitemap.ts`  
**Issue:** SEO sitemap eksik  
**Action:** Dynamic sitemap generator
```typescript
export default function sitemap(): MetadataRoute.Sitemap {
  return [
    {
      url: 'https://busbuskimki.com',
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 1,
    },
    // Add all routes
  ];
}
```
**Priority:** High  
**Time:** 2 hours

---

## ðŸŸ¡ MEDIUM PRIORITY

### 10. CI/CD Pipeline
**File:** `.github/workflows/ci.yml`  
**Issue:** Automated testing/deployment yok  
**Action:** GitHub Actions workflow
```yaml
name: CI/CD
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm ci
      - run: npm run typecheck
      - run: npm run lint
      - run: npm run test
```
**Priority:** Medium  
**Time:** 3 hours

### 11. Bundle Analysis
**File:** `package.json`  
**Issue:** Bundle size analysis eksik  
**Action:**
```bash
npm install --save-dev @next/bundle-analyzer
```
**File:** `next.config.js`
```javascript
const withBundleAnalyzer = require('@next/bundle-analyzer')({
  enabled: process.env.ANALYZE === 'true',
});
module.exports = withBundleAnalyzer(nextConfig);
```
**Priority:** Medium  
**Time:** 1 hour

### 12. Translation Coverage
**Files:** `messages/en.json`, `messages/sr.json`, `src/app/[locale]/auth/page.tsx`  
**Issue:** 283 eksik EN Ã§eviri, 1011 eksik SR Ã§eviri, hardcoded strings  
**Action:** 
- Eksik Ã§evirileri tamamla (EN: 283, SR: 1011)
- Auth sayfasÄ±ndaki hardcoded TÃ¼rkÃ§e metinleri i18n keys ile deÄŸiÅŸtir
- Translation coverage testleri ekle
**Priority:** Medium  
**Time:** 8 hours

### 13. Performance Monitoring
**File:** `src/lib/analytics.ts`  
**Issue:** Web Vitals tracking eksik  
**Action:** Google Analytics 4 + Core Web Vitals
```typescript
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

function sendToAnalytics(metric) {
  gtag('event', metric.name, {
    value: Math.round(metric.value),
    event_category: 'Web Vitals',
  });
}

getCLS(sendToAnalytics);
getFID(sendToAnalytics);
// etc.
```
**Priority:** Medium  
**Time:** 2 hours

---

## ðŸŸ¢ NICE-TO-HAVE

### 14. Advanced Caching
**Files:** `src/lib/cache/redis.ts`  
**Issue:** Redis/CDN caching yok  
**Action:** Redis cache layer implementation  
**Priority:** Low  
**Time:** 8 hours

### 15. A/B Testing Framework
**File:** `src/lib/experiments.ts`  
**Issue:** Feature flags yok  
**Action:** LaunchDarkly veya custom solution  
**Priority:** Low  
**Time:** 6 hours

### 16. Mobile App Wrapper
**File:** `mobile/` directory  
**Issue:** Native mobile app yok  
**Action:** React Native veya Capacitor wrapper  
**Priority:** Low  
**Time:** 20 hours

### 17. Advanced Analytics
**File:** `src/lib/user-tracking.ts`  
**Issue:** User behavior tracking eksik  
**Action:** Mixpanel veya Amplitude integration  
**Priority:** Low  
**Time:** 4 hours

---

## ðŸ“‹ Implementation Checklist

### Week 1: Hotfixes
- [ ] Environment secrets cleanup
- [ ] TypeScript test configuration
- [ ] Security headers hardening
- [ ] Rate limiting activation

### Week 2: High Priority
- [ ] Error monitoring setup
- [ ] Image optimization
- [ ] Legal pages creation
- [ ] Webhook security

### Week 3: High Priority (cont.)
- [ ] XML sitemap generation
- [ ] Performance monitoring
- [ ] Translation coverage audit

### Week 4: Medium Priority
- [ ] CI/CD pipeline
- [ ] Bundle analysis
- [ ] Additional performance optimizations

---

## ðŸŽ¯ Success Metrics

### Before Fixes
- Production Readiness: 75/100
- Security Score: 70/100
- Performance Score: 80/100

### After Hotfixes
- Production Readiness: 85/100
- Security Score: 90/100
- Performance Score: 85/100

### After High Priority
- Production Readiness: 95/100
- Security Score: 95/100
- Performance Score: 90/100

---

## ðŸ“ž Support Contacts

- **Security Issues:** Security team
- **Performance Issues:** DevOps team
- **Translation Issues:** Content team
- **Legal Issues:** Legal team

**Note:** Bu liste production deployment Ã¶ncesi tamamlanmalÄ±dÄ±r. Her item iÃ§in test ve validation gerekir.